<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>내 위치 지도 열기</title>
  <style>
    body { font-family: system-ui, sans-serif; padding: 16px; line-height: 1.4; }
    button { width: 100%; padding: 14px; font-size: 16px; margin: 8px 0; border-radius: 10px; border: 1px solid #ddd; }
    .box { margin-top: 12px; padding: 12px; border: 1px solid #ddd; border-radius: 10px; }
    .muted { color: #666; }
  </style>
</head>
<body>
  <h2>내 현재 위치를 지도에서 열기</h2>
  <p class="muted">버튼을 누르면 위치 권한을 요청하고, 선택한 지도앱/웹지도로 이동합니다.</p>

  <button onclick="openMap('kakao')">카카오맵으로 열기</button>
  <button onclick="openMap('naver')">네이버지도로 열기</button>
  <button onclick="openMap('google')">구글지도로 열기</button>

  <div class="box">
    <div><b>위도</b>: <span id="lat">-</span></div>
    <div><b>경도</b>: <span id="lng">-</span></div>
    <div><b>정확도</b>: <span id="acc">-</span> m</div>
  </div>

  <script>
    function getLocation() {
      return new Promise((resolve, reject) => {
        if (!navigator.geolocation) return reject(new Error("이 브라우저는 위치 기능을 지원하지 않습니다."));
        navigator.geolocation.getCurrentPosition(
          (pos) => resolve(pos),
          (err) => reject(err),
          { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
        );
      });
    }

    async function openMap(provider) {
      try {
        const pos = await getLocation();
        const lat = pos.coords.latitude;
        const lng = pos.coords.longitude;
        const acc = Math.round(pos.coords.accuracy);

        document.getElementById("lat").textContent = lat.toFixed(6);
        document.getElementById("lng").textContent = lng.toFixed(6);
        document.getElementById("acc").textContent = acc;

        // 가장 “바로 쓰는” 목적이라, 앱 설치 여부와 무관하게 웹 URL 위주로 열도록 구성
        let url = "";
        if (provider === "kakao") {
          // 카카오맵 웹: 현재 좌표 중심으로 표시
          url = `https://map.kakao.com/link/map/${lat},${lng}`;
        } else if (provider === "naver") {
          // 네이버 지도 웹: 좌표 중심
          url = `https://map.naver.com/v5/?c=${lng},${lat},15,0,0,0,dh`;
        } else {
          // 구글 지도: 좌표 검색
          url = `https://www.google.com/maps/search/?api=1&query=${lat},${lng}`;
        }
        window.location.href = url;
      } catch (e) {
        alert(
          "위치 권한이 필요합니다.\n\n" +
          "- iPhone: 설정 > Safari > 위치 또는 사이트 설정에서 허용\n" +
          "- Android: 브라우저 권한에서 위치 허용\n\n" +
          "에러: " + (e.message || e)
        );
      }
    }
  </script>
</body>
</html>
